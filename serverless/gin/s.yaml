edition: 1.0.0 # YAML规范版本，遵循语义化版本（Semantic Versioning）规范
name: serverless-gin # 项目/应用名称
access: default # 秘钥别名

vars: # 全局变量
  region: 'cn-zhangjiakou'
  service:
    name: 'serverless-gin'
    description: 'Serverless Devs Gin Web Framework Service'
    internetAccess: false

services:
  serverless-gin: # 业务名称/模块名称
    component: fc # 组件名称
    actions: # 自定义执行逻辑
      pre-deploy:
        - run: go mod tidy
          path: ./code
        - run: GOOS=linux GOARCH=amd64 CGO_ENABLED=0 go build -o target/main main.go
          path: ./code
    props: # 组件的属性值
      region: ${vars.region}
      service: ${vars.service}
      function:
        name: serverless-gin
        description: 'serverless gin'
        codeUri: ./code/target # 代码位置
        runtime: custom.debian10
        cpu: 0.05
        memorySize: 128
        diskSize: 512
        timeout: 30
        instanceType: e1
        instanceConcurrency: 100
        caPort: 8080 # CustomContainer/Runtime 指定端口
        customRuntimeConfig:
          command:
            - '/code/main'
        environmentVariables:
          TZ: 'Asia/Shanghai'
      triggers:
        - name: httpTrigger
          type: http
          qualifier: LATEST
          config:
            authType: anonymous
            disableURLInternet: false
            methods:
              - GET
              - POST
      customDomains:
        - domainName: auto
          protocol: HTTP
          routeConfigs:
            - path: /*
